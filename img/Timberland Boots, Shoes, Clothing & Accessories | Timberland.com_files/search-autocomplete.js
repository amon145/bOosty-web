define(["jquery","wcs.context","promise!wcs.lang-msg","jquery-ui"],function(a,b){function c(b,c,d){a.ajax({url:ACTION_URLS.ARTICLESEARCH_URL,data:{path:AEM.PATH,q:b,max:AEM.MAX},dataType:"json",success:function(b){var e=[];a.each(b.hits,function(a){var c=b.hits[a],d=c["cq:tags"][0];void 0===d&&(d="");var f=c["jcr:path"];f.indexOf(".html")<0&&(f+=".html");var g={label:c["jcr:title"],category:d,price:"",image:c.thumbnailDesktop,url:f};e.push(g)}),d(c.concat(e))},error:function(){d(c)}})}function d(d,e){var f=a("#siteLangId").val();a.widget("custom.catcomplete",a.ui.autocomplete,{highLightTerm:function(a,b){var c=new RegExp(b,"ig");return a.replace(c,'<span class="term">'+b+"</span>")},_renderItem:function(b,c){var e;e=-1==f?'<span class="item-price">'+c.price+"</span>":"";var g='<li data-value="'+c.value+'"><a href="'+c.url+'"><div class="item-image"><figure><img alt="'+c.value+'" src="'+c.image+'"></figure></div><div class="item-desc"><p class="item-category">'+c.category+'</p><div class="item-info"><p class="item-name">'+this.highLightTerm(a("<div/>").html(c.value).text(),d.val())+"</p>"+e+"</div></div></a></li>";return a(g).appendTo(b)},_renderMenu:function(b,c){b.addClass("more content search-items"),"true"===hideSearchResultsOnMobile&&b.addClass("hide-search-results-on-mobile");var e=this,f='<li class="search-suggestion" data-value="'+d.val()+'"><a class="search-js">'+LANG_MSG["SEARCH.search.all"]+' <span>&quot;<span class="term search-term-js">'+d.val()+"</span>&quot;</span></a></li>",g=c[0].suggestions,h="";"true"==productSearchSuggestionKeywordsEnabled&&(h+='<li class="search-suggestion search-keywords"><div><span>'+LANG_MSG["SEARCH.keywords"]+": </span>",a.each(g,function(a,b){h+='<a href="" class="search-js">&quot;<span class="term search-term-js">'+b.keyword+"</span>&quot;</a>",a!=c[0].suggestions.length-1&&(h+=",")}),h+="</div></li>"),b.prepend(f+h);var i=0;a.each(c,function(a,c){i>0&&e._renderItemData(b,c),i++})}}),d.catcomplete({minLength:e.minLength||3,delay:e.delay||500,source:function(d,e){a.ajax({url:a(".url-autocomplete").val()||ACTION_URLS.AUTOCOMPLETE_URL,dataType:"json",data:{langId:b.getLangId(),storeId:b.getStoreId(),catalogId:b.getCatalogId(),count:3,term:d.term},success:function(a){AEM?c(d.term,a.results,e):e(a.results)}})},position:e.position||{my:"left top+2",at:"left bottom"},appendTo:e.appendTo||".ui-front",select:function(b,c){b.preventDefault();var d=a(b.target),e=a("<div>").html(c.item.value);d.val(e.text()),window.location=c.item.url},open:function(a,b){e.open&&e.open(a,b)},close:function(a,b){e.close&&e.close(a,b)}})}a(document).on("click",".search-js",function(b){b.preventDefault(),a(".header-search-term-input-js").val(a(b.target).find(".search-term-js").text()),a(".search-form-js").submit()}),a(document).on("click",".search-term-js",function(b){b.preventDefault(),a(".header-search-term-input-js").val(a(b.target).html()),a(".search-form-js").submit()}),a(function(){var b={appendTo:".ui-suggestion-list",position:{my:"right+31 top+10",at:"right bottom"},open:function(b,c){a(".ui-autocomplete-container .indicator").length<1&&a(".ui-autocomplete-container").prepend('<span class="indicator hide"></span>'),a(".ui-autocomplete-container .indicator").removeClass("hide")},close:function(b,c){a(".ui-autocomplete-container .indicator").addClass("hide")}};"true"===headerAutoSuggestEnabled&&d(a(".search-input-js"),b)})});
//# sourceMappingURL=search-autocomplete.js.map